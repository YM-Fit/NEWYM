# ğŸ“Š Tanita Scale Realtime Integration

## ×¡×§×™×¨×” ×›×œ×œ×™×ª

×”××¢×¨×›×ª ×›×•×œ×œ×ª ×¤×™×¦'×¨ ××ª×§×“× ×œ×§×œ×™×˜×ª × ×ª×•× ×™× ×‘×–××Ÿ ×××ª ×××©×§×œ Tanita ×—×™×¦×•× ×™. ×”× ×ª×•× ×™× × ×©×œ×—×™× ×“×¨×š ×¡×§×¨×™×¤×˜ Python ×™×©×™×¨×•×ª ×œ×˜×‘×œ×ª Buffer ×‘××¡×“ ×”× ×ª×•× ×™×, ×•×”×××©×§ ××ª×¢×“×›×Ÿ ××•×˜×•××˜×™×ª.

---

## ğŸ—ï¸ ××¨×›×™×˜×§×˜×•×¨×”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tanita Scale   â”‚
â”‚   (Hardware)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Python Script  â”‚
â”‚  (Your Script)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Supabase DB   â”‚
â”‚ scale_readings  â”‚
â”‚     (Table)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    Realtime âš¡
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   React Hook    â”‚
â”‚ useScaleListenerâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Measurement Formâ”‚
â”‚  (Auto-fill)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ ××” ×‘×•×¦×¢?

### 1ï¸âƒ£ **×˜×‘×œ×ª `scale_readings`**

× ×•×¦×¨×” ×˜×‘×œ×” ×—×“×©×” ×‘××¡×“ ×”× ×ª×•× ×™×:

```sql
CREATE TABLE scale_readings (
  id                bigint PRIMARY KEY,
  created_at        timestamptz DEFAULT now(),
  weight_kg         numeric(5,2),
  body_fat_percent  numeric(4,2),
  fat_mass_kg       numeric(5,2),
  fat_free_mass_kg  numeric(5,2),
  water_kg          numeric(5,2),
  water_percent     numeric(4,2),
  bmi               numeric(4,2)
);
```

**×ª×›×•× ×•×ª ××™×•×—×“×•×ª:**
- âœ… **Realtime enabled** - ×”×˜×‘×œ×” ××•×¤×¢×œ×ª ×œ-Realtime replication
- âœ… **RLS (Row Level Security)** - ×××•×‘×˜×— ×œ×—×œ×•×˜×™×Ÿ
- âœ… **Auto-cleanup** - ××“×™×“×•×ª ×™×©× ×•×ª (7+ ×™××™×) × ××—×§×•×ª ××•×˜×•××˜×™×ª
- âœ… **Indexes** - ×—×™×¤×•×© ××”×™×¨ ×œ×¤×™ ×ª××¨×™×š

### 2ï¸âƒ£ **Custom Hook: `useScaleListener`**

Hook ××•×ª×× ××™×©×™×ª ×©×××–×™×Ÿ ×œ× ×ª×•× ×™× ×—×“×©×™×:

```typescript
const { latestReading, isListening, error } = useScaleListener();
```

**×œ×•×’×™×§×” ×—×›××”:**
- ğŸ” ×××–×™×Ÿ ×¨×§ ×œ-INSERT events
- â±ï¸ ××§×‘×œ ×¨×§ ×©×§×™×œ×•×ª ×©× ×•×¦×¨×• ×‘**30 ×©× ×™×•×ª ×”××—×¨×•× ×•×ª**
- ğŸš« ××ª×¢×œ× ××©×§×™×œ×•×ª ×™×©× ×•×ª (×œ×× ×™×¢×ª ×˜×¢×™× ×ª ×”×™×¡×˜×•×¨×™×”)
- ğŸ“¡ ×× ×”×œ ×—×™×‘×•×¨ Realtime ××•×˜×•××˜×™×ª
- ğŸ”Œ ×× ×§×” ×—×™×‘×•×¨×™× ×‘×¢×ª unmount

### 3ï¸âƒ£ **×©×™×œ×•×‘ ×‘×˜×•×¤×¡ ×”××“×™×“×•×ª**

×”×˜×•×¤×¡ ×¢×•×“×›×Ÿ ×œ:

```typescript
// ×§×œ×™×˜×” ××•×˜×•××˜×™×ª
useEffect(() => {
  if (latestReading && !isEditing) {
    setFormData({
      weight: latestReading.weight_kg,
      bodyFat: latestReading.body_fat_percent,
      muscleMass: latestReading.fat_free_mass_kg,
      waterPercentage: latestReading.water_percent,
      source: 'tanita'
    });

    // Toast notification
    setShowScaleDataToast(true);
  }
}, [latestReading]);
```

**×¤×™×¦'×¨×™×:**
- âœ… **Auto-fill** - ×›×œ ×”×©×“×•×ª ××ª××œ××™× ××•×˜×•××˜×™×ª
- âœ… **Toast notification** - ×”×•×“×¢×” ×™×¨×•×§×” ×œ××©×š 5 ×©× ×™×•×ª
- âœ… **Status indicator** - × ×§×•×“×” ×™×¨×•×§×” ××”×‘×”×‘×ª "×××–×™×Ÿ ×œ××©×§×œ Tanita"
- âœ… **Source auto-set** - ××’×“×™×¨ ××•×˜×•××˜×™×ª ×œ-"Tanita"

### 4ï¸âƒ£ **×•×™×–×•××œ×™×”**

**Toast Notification:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ ×”×ª×§×‘×œ×• × ×ª×•× ×™× ××”××©×§×œ!            â”‚
â”‚   ×”×©×“×•×ª ××•×œ××• ××•×˜×•××˜×™×ª             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Status Indicator:**
```
×™×•×¡×™ ×›×”×Ÿ
××“×™×“×” ×—×“×©×”
â— ×××–×™×Ÿ ×œ××©×§×œ Tanita  <-- × ×§×•×“×” ×™×¨×•×§×” ××”×‘×”×‘×ª
```

---

## ğŸ”§ ××™×š ×œ×”×©×ª××©?

### ×©×œ×‘ 1: ×¡×§×¨×™×¤×˜ Python

×”×¡×§×¨×™×¤×˜ ×©×œ×š ×¦×¨×™×š ×œ×©×œ×•×— × ×ª×•× ×™× ×œ-Supabase:

```python
from supabase import create_client
import os

supabase_url = os.getenv('SUPABASE_URL')
supabase_key = os.getenv('SUPABASE_SERVICE_KEY')  # ×—×©×•×‘: SERVICE_KEY!
supabase = create_client(supabase_url, supabase_key)

# × ×ª×•× ×™× ×××©×§×œ Tanita
scale_data = {
    'weight_kg': 85.3,
    'body_fat_percent': 18.5,
    'fat_mass_kg': 15.8,
    'fat_free_mass_kg': 69.5,
    'water_kg': 50.2,
    'water_percent': 58.8,
    'bmi': 24.7
}

# ×©×œ×™×—×” ×œ-Supabase
result = supabase.table('scale_readings').insert(scale_data).execute()
print(f"Data sent: {result}")
```

**âš ï¸ ×—×©×•×‘:**
- ×”×©×ª××© ×‘-`SUPABASE_SERVICE_KEY` ×•×œ× ×‘-`ANON_KEY`
- ×•×•×“× ×©×”-Python script ×¨×¥ ×‘××•×ª×• ×¨×©×ª ××• ×¢× ×’×™×©×” ×œ××™× ×˜×¨× ×˜

### ×©×œ×‘ 2: ×¤×ª×™×—×ª ×˜×•×¤×¡ ××“×™×“×”

1. ×”×™×›× ×¡ ×œ××¢×¨×›×ª
2. ×‘×—×¨ ××ª×××Ÿ
3. ×œ×—×¥ ×¢×œ "××“×™×“×” ×—×“×©×”"
4. ×”××¢×¨×›×ª ×ª×ª×—×™×œ ×œ×”××–×™×Ÿ ××•×˜×•××˜×™×ª (×ª×¨××” × ×§×•×“×” ×™×¨×•×§×”)

### ×©×œ×‘ 3: ×©×§×™×œ×”

1. ×”××ª×××Ÿ ×¢×•×œ×” ×¢×œ ×”××©×§×œ
2. ×”××©×§×œ ×©×•×œ×— × ×ª×•× ×™× ×œ×¡×§×¨×™×¤×˜ Python
3. ×”×¡×§×¨×™×¤×˜ ×©×•×œ×— ×œ-Supabase
4. **×ª×•×š 1-2 ×©× ×™×•×ª** - ×”×©×“×•×ª ××ª××œ××™× ××•×˜×•××˜×™×ª!
5. ×ª×¨××” Toast ×™×¨×•×§ ×œ××©×š 5 ×©× ×™×•×ª

### ×©×œ×‘ 4: ×©××™×¨×”

- ×‘×“×•×§ ××ª ×”× ×ª×•× ×™× (× ×™×ª×Ÿ ×œ×¢×¨×•×š ×‘××™×“×ª ×”×¦×•×¨×š)
- ×”×•×¡×£ ×”×™×§×¤×™ ×’×•×£ ×™×“× ×™×ª (××•×¤×¦×™×•× ×œ×™)
- ×œ×—×¥ "×©××•×¨ ××“×™×“×”"

---

## ğŸ§ª ×‘×“×™×§×” ×™×“× ×™×ª (×œ×œ× ××©×§×œ)

×× ××™×Ÿ ×œ×š ××©×§×œ ×¤×™×–×™, ××¤×©×¨ ×œ×‘×“×•×§ ×¢× SQL:

```sql
-- ×”×›× ×¡ × ×ª×•× ×™× ×™×“× ×™×ª ×‘-Supabase SQL Editor
INSERT INTO scale_readings (
  weight_kg,
  body_fat_percent,
  fat_mass_kg,
  fat_free_mass_kg,
  water_kg,
  water_percent,
  bmi
) VALUES (
  85.3,
  18.5,
  15.8,
  69.5,
  50.2,
  58.8,
  24.7
);
```

**×¦×¤×•×™ ×œ×¨××•×ª:**
1. Toast ×™×¨×•×§ ××•×¤×™×¢
2. ×›×œ ×”×©×“×•×ª ××ª××œ××™×
3. "××§×•×¨ ×”××“×™×“×”" ××©×ª× ×” ×œ-Tanita

---

## ğŸ” Troubleshooting

### ×‘×¢×™×”: ×œ× ×¨×•××” "×××–×™×Ÿ ×œ××©×§×œ"

**×¤×ª×¨×•×Ÿ:**
1. ×‘×“×•×§ ×©×”-Realtime ××•×¤×¢×œ ×‘×˜×‘×œ×”:
   ```sql
   ALTER PUBLICATION supabase_realtime ADD TABLE scale_readings;
   ```
2. ×‘×“×•×§ ××ª ×”×§×•× ×¡×•×œ (F12) - ×¦×¨×™×š ×œ×¨××•×ª:
   ```
   âœ… Subscribed to scale readings channel
   ```

### ×‘×¢×™×”: × ×ª×•× ×™× ×œ× ××ª×§×‘×œ×™×

**×¤×ª×¨×•×Ÿ:**
1. ×‘×“×•×§ ×©-RLS ××•×’×“×¨ × ×›×•×Ÿ:
   ```sql
   SELECT * FROM scale_readings LIMIT 1;
   ```
2. ×•×•×“× ×©×”×¡×§×¨×™×¤×˜ Python ××©×ª××© ×‘-`SERVICE_KEY`
3. ×‘×“×•×§ ×©×”×©×§×™×œ×” ×‘×•×¦×¢×” ×‘-30 ×”×©× ×™×•×ª ×”××—×¨×•× ×•×ª

### ×‘×¢×™×”: Toast ×œ× × ×¢×œ×

**×¨×¢× ×•×Ÿ ×“×¤×“×¤×Ÿ** - ×œ×¤×¢××™× ×¦×¨×™×š Ctrl+Shift+R

---

## ğŸ¯ ×™×ª×¨×•× ×•×ª

âœ… **××•×˜×•××¦×™×” ××œ××”** - ××¤×¡ ×”×§×œ×“×” ×™×“× ×™×ª
âœ… **×‘×–××Ÿ ×××ª** - ×¢×“×›×•×Ÿ ×ª×•×š ×©× ×™×•×ª
âœ… **×“×™×•×§ ×’×‘×•×”** - ××™×Ÿ ×˜×¢×•×™×•×ª ×”×§×œ×“×”
âœ… **×—×•×•×™×™×ª ××©×ª××©** - × ×¨××” ××§×¦×•×¢×™ ×•×—×œ×§
âœ… **×—×¡×›×•×Ÿ ×–××Ÿ** - 90% ×¤×—×•×ª ×–××Ÿ ×œ×ª×™×¢×•×“

---

## ğŸ“ ×”×¢×¨×•×ª ×—×©×•×‘×•×ª

1. **×¨×§ ×‘×˜×•×¤×¡ ×—×“×©:** ×”×”××–× ×” ×¤×¢×™×œ×” ×¨×§ ×›×©×™×•×¦×¨×™× ××“×™×“×” ×—×“×©×” (×œ× ×‘×¢×¨×™×›×”)
2. **30 ×©× ×™×•×ª:** ×”×©×§×™×œ×” ×—×™×™×‘×ª ×œ×”×™×•×ª ×˜×¨×™×™×” (×ª×•×š 30 ×©× ×™×•×ª)
3. **Cleanup:** ××“×™×“×•×ª ×™×©× ×•×ª × ××—×§×•×ª ××•×˜×•××˜×™×ª ××—×¨×™ 7 ×™××™×
4. **××‘×˜×—×”:** ×”×˜×‘×œ×” ×××•×‘×˜×—×ª ×‘-RLS - ×¨×§ ××©×ª××©×™× ××—×•×‘×¨×™×

---

## ğŸš€ ××” ×”×œ××”?

×¨×¢×™×•× ×•×ª ×œ×©×™×¤×•×¨×™× ×¢×ª×™×“×™×™×:

- ğŸ“± **××¤×œ×™×§×¦×™×™×ª ××•×‘×™×™×œ** - ×”×ª×—×‘×¨ ×™×©×™×¨×•×ª ×œ××©×§×œ ×‘×‘×œ×•×˜×•×ª'
- ğŸ“Š **×’×¨×¤×™× ×‘×–××Ÿ ×××ª** - ×¢×“×›×•×Ÿ ×”×’×¨×¤×™× ××™×™×“×™×ª ××—×¨×™ ×©×§×™×œ×”
- ğŸ”” **×”×ª×¨××•×ª** - ×”×•×“×¢×ª Push ×›×©×”××ª×××Ÿ ×”×ª×©×§×œ
- ğŸ“ˆ **Machine Learning** - ×—×™×–×•×™ ××©×§×œ ×¢×ª×™×“×™
- ğŸ† **Gamification** - ××ª×’×¨×™× ×•×™×¢×“×™×

---

**âœ… ×”××¢×¨×›×ª ××•×›× ×” ×œ×©×™××•×©!**

× ×•×¦×¨ ×¢×œ ×™×“×™ YM Coach Team ğŸ’ª
