# דוח בדיקת נתונים - יומן אכילה

## תאריך בדיקה: 2026-01-23

### סיכום כללי
הבדיקה בוצעה על הטבלאות הקשורות ליומן האכילה והתזונה במערכת.

---

## 1. טבלת `meals` (ארוחות)

### סטטיסטיקות:
- **סה"כ רשומות**: 14
- **מספר מתאמנים ייחודיים**: 1
- **טווח תאריכים**: 2025-12-07 עד 2026-01-11

### ממצאים:
- ✅ כל הארוחות יש להן `trainee_id`, `meal_date`, `meal_type`, `description`
- ⚠️ **כל 14 הארוחות אין להן ערכים תזונתיים** (calories, protein, carbs, fat כולם null)
- ✅ אין תאריכים עתידיים או ישנים מדי
- ✅ המבנה של הטבלה תקין

### המלצות:
- רוב הארוחות נרשמו ללא ערכים תזונתיים. זה תקין אם המשתמש לא הזין אותם, אבל כדאי לבדוק אם יש בעיה בשמירת הנתונים.

---

## 2. טבלת `daily_log` (יומן יומי - מים)

### סטטיסטיקות:
- **סה"כ רשומות**: 4
- **מספר מתאמנים ייחודיים**: 1
- **טווח תאריכים**: 2025-12-10 עד 2026-01-14
- **ממוצע מים**: 750 מ"ל

### ממצאים:
- ✅ כל הרשומות יש להן `trainee_id`, `log_date`, `water_ml`
- ✅ אין תאריכים עתידיים או ישנים מדי
- ✅ המבנה של הטבלה תקין

---

## 3. טבלת `food_diary` (יומן אכילה)

### סטטיסטיקות:
- **סה"כ רשומות**: 11
- **מספר מתאמנים ייחודיים**: 1
- **טווח תאריכים**: 2025-12-07 עד 2026-01-11
- **רשומות שהושלמו**: 11 (100%)

### ממצאים:
- ✅ כל הרשומות מסומנות כהושלמו (`completed = true`)
- ✅ אין תאריכים עתידיים או ישנים מדי
- ✅ המבנה של הטבלה תקין

---

## 4. טבלת `meal_plans` (תכניות תזונה)

### סטטיסטיקות:
- **סה"כ תכניות**: 3
- **תכניות פעילות**: 2
- **תכניות לא פעילות**: 1

### ממצאים:
- ✅ יש תכנית פעילה למתאמן `d7a26867-5e31-42c8-a2cd-e0d35b18ff26`
- ✅ המבנה של הטבלה תקין

---

## 5. טבלת `meal_plan_meals` (ארוחות בתכנית)

### סטטיסטיקות:
- **סה"כ ארוחות**: 3
- **ארוחות עם food_items**: 2
- **ארוחות בלי food_items**: 1

### ממצאים:
- ✅ 2 ארוחות יש להן פריטי מזון (`meal_plan_food_items`)
- ✅ אחת מהארוחות יש לה ערכים תזונתיים (40 קלוריות, 7 גרם חלבון)
- ⚠️ ארוחה אחת אין לה פריטי מזון
- ✅ המבנה של הטבלה תקין

---

## 6. טבלת `meal_plan_food_items` (פריטי מזון)

### ממצאים:
- ✅ יש 2 פריטי מזון בטבלה
- ✅ אחד מהם יש לו ערכים תזונתיים
- ✅ המבנה של הטבלה תקין

---

## סיכום כללי

### ✅ נקודות חיוביות:
1. כל הטבלאות קיימות ומבנה הנתונים תקין
2. אין תאריכים לא תקינים (עתידיים או ישנים מדי)
3. כל הרשומות קשורות למתאמן תקין
4. אין רשומות יתומות (orphaned records)

### ⚠️ נקודות שדורשות תשומת לב:
1. **כל הארוחות בטבלת `meals` אין להן ערכים תזונתיים** - זה יכול להיות תקין אם המשתמש לא הזין אותם, אבל כדאי לבדוק:
   - האם יש בעיה בשמירת הנתונים בטופס?
   - האם המשתמש לא מזין ערכים תזונתיים בכוונה?
2. **ארוחה אחת בתכנית אין לה פריטי מזון** - זה יכול להיות תקין אם הארוחה ריקה או עדיין לא הושלמה

### 🔍 המלצות לבדיקה נוספת:
1. לבדוק את הקוד ב-`FoodDiary.tsx` - האם הערכים התזונתיים נשמרים נכון?
2. לבדוק את ה-RLS policies - האם יש בעיות גישה?
3. לבדוק את הלוגים - האם יש שגיאות בשמירת נתונים?

---

## מבנה הטבלאות - אימות

### ✅ `meals` - כל השדות הנדרשים קיימים:
- `id` (uuid)
- `trainee_id` (uuid)
- `meal_date` (date)
- `meal_type` (varchar)
- `meal_time` (time)
- `description` (text)
- `calories` (integer, nullable)
- `protein` (integer, nullable)
- `carbs` (integer, nullable)
- `fat` (integer, nullable)

### ✅ `daily_log` - כל השדות הנדרשים קיימים:
- `id` (uuid)
- `trainee_id` (uuid)
- `log_date` (date)
- `water_ml` (integer)

### ✅ `food_diary` - כל השדות הנדרשים קיימים:
- `id` (uuid)
- `trainee_id` (uuid)
- `diary_date` (date)
- `completed` (boolean)
- `completed_at` (timestamptz, nullable)
- `is_seen_by_trainer` (boolean, nullable)

---

## מסקנה

הנתונים במסד הנתונים נראים תקינים מבחינה מבנית. הבעיה העיקרית היא שכל הארוחות בטבלת `meals` אין להן ערכים תזונתיים, מה שיכול להצביע על בעיה בשמירת הנתונים או שהמשתמש פשוט לא מזין אותם.

מומלץ לבדוק:
1. את הקוד ב-`FoodDiary.tsx` - האם הערכים התזונתיים נשמרים נכון?
2. את הקונסול בדפדפן - האם יש שגיאות JavaScript?
3. את הלוגים של Supabase - האם יש שגיאות בשמירת נתונים?
